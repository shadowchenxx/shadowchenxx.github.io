<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Hive的元数据表结构详解"><meta name="keywords" content="Hive"><meta name="author" content="zhiyong.chen"><meta name="copyright" content="zhiyong.chen"><title>Hive的元数据表结构详解 | Shadowchen's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-VERSION"><span class="toc-number">1.</span> <span class="toc-text">1.VERSION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-DBS、DATABASE-PARAMS"><span class="toc-number">2.</span> <span class="toc-text">2.DBS、DATABASE_PARAMS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-TBLS、TABLE-PARAMS、TBL-PRIV"><span class="toc-number">3.</span> <span class="toc-text">3.TBLS、TABLE_PARAMS、TBL_PRIV</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Hive文件存储信息相关的元数据表"><span class="toc-number">4.</span> <span class="toc-text">4.Hive文件存储信息相关的元数据表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Hive表字段相关的元数据表"><span class="toc-number">5.</span> <span class="toc-text">5.Hive表字段相关的元数据表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-Hive表分区相关的元数据表"><span class="toc-number">6.</span> <span class="toc-text">6.Hive表分区相关的元数据表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-其他不常用的元数据表"><span class="toc-number">7.</span> <span class="toc-text">7.其他不常用的元数据表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例"><span class="toc-number"></span> <span class="toc-text">示例</span></a></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">zhiyong.chen</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">66</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">64</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Shadowchen's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Hive的元数据表结构详解</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-11-08</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h4 id="1-VERSION"><a href="#1-VERSION" class="headerlink" title="1.VERSION"></a>1.VERSION</h4><table>
<thead>
<tr>
<th><strong>VER_ID</strong></th>
<th><strong>SCHEMA_VERSION</strong></th>
<th><strong>VERSION_COMMENT</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID主键</td>
<td>Hive版本</td>
<td>版本说明</td>
</tr>
<tr>
<td>1</td>
<td>0.13.0</td>
<td>Set by MetaStore</td>
</tr>
</tbody></table>
<p>如果该表出现问题，根本进入不了Hive-Cli。</p>
<p>比如该表不存在，当启动Hive-Cli时候，就会报错”Table ‘hive.version’ doesn’t exist”.</p>
<a id="more"></a>

<h4 id="2-DBS、DATABASE-PARAMS"><a href="#2-DBS、DATABASE-PARAMS" class="headerlink" title="2.DBS、DATABASE_PARAMS"></a>2.DBS、DATABASE_PARAMS</h4><ul>
<li>DBS</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>DB_ID</strong></td>
<td>数据库ID</td>
<td>2</td>
</tr>
<tr>
<td><strong>DESC</strong></td>
<td>数据库描述</td>
<td>测试库</td>
</tr>
<tr>
<td><strong>DB_LOCATION_URI</strong></td>
<td>数据库HDFS路径</td>
<td>hdfs://namenode/user/hive/warehouse/lxw1234.db</td>
</tr>
<tr>
<td><strong>NAME</strong></td>
<td>数据库名</td>
<td>lxw1234</td>
</tr>
<tr>
<td><strong>OWNER_NAME</strong></td>
<td>数据库所有者用户名</td>
<td>lxw1234</td>
</tr>
<tr>
<td><strong>OWNER_TYPE</strong></td>
<td>所有者角色</td>
<td>USER</td>
</tr>
</tbody></table>
<ul>
<li>DATABASE_PARAMS</li>
</ul>
<p>该表存储数据库的相关参数，在CREATE DATABASE时候用</p>
<p>WITH DBPROPERTIES (property_name=property_value, …)指定的参数。</p>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>DB_ID</strong></td>
<td>数据库ID</td>
<td>2</td>
</tr>
<tr>
<td><strong>PARAM_KEY</strong></td>
<td>参数名</td>
<td>createdby</td>
</tr>
<tr>
<td><strong>PARAM_VALUE</strong></td>
<td>参数值</td>
<td>lxw1234</td>
</tr>
</tbody></table>
<p>DBS和DATABASE_PARAMS这两张表通过DB_ID字段关联.</p>
<h4 id="3-TBLS、TABLE-PARAMS、TBL-PRIV"><a href="#3-TBLS、TABLE-PARAMS、TBL-PRIV" class="headerlink" title="3.TBLS、TABLE_PARAMS、TBL_PRIV"></a>3.TBLS、TABLE_PARAMS、TBL_PRIV</h4><ul>
<li>TBLS（该表中存储Hive表、视图、索引表的基本信息）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>TBL_ID</strong></td>
<td>表ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>CREATE_TIME</strong></td>
<td>创建时间</td>
<td>1436317071</td>
</tr>
<tr>
<td><strong>DB_ID</strong></td>
<td>数据库ID</td>
<td>2，对应DBS中的DB_ID</td>
</tr>
<tr>
<td><strong>LAST_ACCESS_TIME</strong></td>
<td>上次访问时间</td>
<td>1436317071</td>
</tr>
<tr>
<td><strong>OWNER</strong></td>
<td>所有者</td>
<td>liuxiaowen</td>
</tr>
<tr>
<td><strong>RETENTION</strong></td>
<td>保留字段</td>
<td>0</td>
</tr>
<tr>
<td><strong>SD_ID</strong></td>
<td>序列化配置信息</td>
<td>86，对应SDS表中的SD_ID</td>
</tr>
<tr>
<td><strong>TBL_NAME</strong></td>
<td>表名</td>
<td>lxw1234</td>
</tr>
<tr>
<td><strong>TBL_TYPE</strong></td>
<td>表类型</td>
<td>MANAGED_TABLE、EXTERNAL_TABLE、INDEX_TABLE、VIRTUAL_VIEW</td>
</tr>
<tr>
<td><strong>VIEW_EXPANDED_TEXT</strong></td>
<td>视图的详细HQL语句</td>
<td>select <code>lxw1234</code>.<code>pt</code>, <code>lxw1234</code>.<code>pcid</code> from <code>liuxiaowen</code>.<code>lxw1234</code></td>
</tr>
<tr>
<td><strong>VIEW_ORIGINAL_TEXT</strong></td>
<td>视图的原始HQL语句</td>
<td>select * from lxw1234</td>
</tr>
</tbody></table>
<ul>
<li>TABLE_PARAMS（存储表/视图的属性信息）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>TBL_ID</strong></td>
<td>表ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>PARAM_KEY</strong></td>
<td>属性名</td>
<td>totalSize、numRows、EXTERNAL</td>
</tr>
<tr>
<td><strong>PARAM_VALUE</strong></td>
<td>属性值</td>
<td>970107336、21231028、TRUE</td>
</tr>
</tbody></table>
<ul>
<li>TBL_PRIVS（存储表/视图的授权信息）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>TBL_GRANT_ID</strong></td>
<td>授权ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>CREATE_TIME</strong></td>
<td>授权时间</td>
<td>1436320455</td>
</tr>
<tr>
<td><strong>GRANT_OPTION</strong></td>
<td></td>
<td>0</td>
</tr>
<tr>
<td><strong>GRANTOR</strong></td>
<td>授权执行用户</td>
<td>liuxiaowen</td>
</tr>
<tr>
<td><strong>GRANTOR_TYPE</strong></td>
<td>授权者类型</td>
<td>USER</td>
</tr>
<tr>
<td><strong>PRINCIPAL_NAME</strong></td>
<td>被授权用户</td>
<td>username</td>
</tr>
<tr>
<td><strong>PRINCIPAL_TYPE</strong></td>
<td>被授权用户类型</td>
<td>USER</td>
</tr>
<tr>
<td><strong>TBL_PRIV</strong></td>
<td>权限</td>
<td>Select、Alter</td>
</tr>
<tr>
<td><strong>TBL_ID</strong></td>
<td>表ID</td>
<td>22，对应TBLS表中的TBL_ID</td>
</tr>
</tbody></table>
<h4 id="4-Hive文件存储信息相关的元数据表"><a href="#4-Hive文件存储信息相关的元数据表" class="headerlink" title="4.Hive文件存储信息相关的元数据表"></a>4.Hive文件存储信息相关的元数据表</h4><p>主要涉及SDS、SD_PARAMS、SERDES、SERDE_PARAMS</p>
<p>由于HDFS支持的文件格式很多，而建Hive表时候也可以指定各种文件格式，Hive在将HQL解析成MapReduce时候，需要知道去哪里，使用哪种格式去读写HDFS文件，而这些信息就保存在这几张表中。</p>
<ul>
<li>SDS</li>
</ul>
<p>该表保存文件存储的基本信息，如INPUT_FORMAT、OUTPUT_FORMAT、是否压缩等。</p>
<p>TBLS表中的SD_ID与该表关联，可以获取Hive表的存储信息。</p>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>SD_ID</strong></td>
<td>存储信息ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>CD_ID</strong></td>
<td>字段信息ID</td>
<td>21，对应CDS表</td>
</tr>
<tr>
<td><strong>INPUT_FORMAT</strong></td>
<td>文件输入格式</td>
<td>org.apache.hadoop.mapred.TextInputFormat</td>
</tr>
<tr>
<td><strong>IS_COMPRESSED</strong></td>
<td>是否压缩</td>
<td>0</td>
</tr>
<tr>
<td><strong>IS_STOREDASSUBDIRECTORIES</strong></td>
<td>是否以子目录存储</td>
<td>0</td>
</tr>
<tr>
<td><strong>LOCATION</strong></td>
<td>HDFS路径</td>
<td>hdfs://namenode/hivedata/warehouse/ut.db/t_lxw</td>
</tr>
<tr>
<td><strong>NUM_BUCKETS</strong></td>
<td>分桶数量</td>
<td>5</td>
</tr>
<tr>
<td><strong>OUTPUT_FORMAT</strong></td>
<td>文件输出格式</td>
<td>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</td>
</tr>
<tr>
<td><strong>SERDE_ID</strong></td>
<td>序列化类ID</td>
<td>3，对应SERDES表</td>
</tr>
</tbody></table>
<ul>
<li>SD_PARAMS（存储Hive存储的属性信息，在创建表时候使用）</li>
</ul>
<p>STORED BY ‘storage.handler.class.name’ [WITH SERDEPROPERTIES (…)指定。</p>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>SD_ID</strong></td>
<td>存储配置ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>PARAM_KEY</strong></td>
<td>存储属性名</td>
<td></td>
</tr>
<tr>
<td><strong>PARAM_VALUE</strong></td>
<td>存储属性值</td>
<td></td>
</tr>
</tbody></table>
<ul>
<li>SERDES（存储序列化使用的类信息）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>SERDE_ID</strong></td>
<td>序列化类配置ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>NAME</strong></td>
<td>序列化类别名</td>
<td></td>
</tr>
<tr>
<td><strong>SLIB</strong></td>
<td>序列化类</td>
<td>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</td>
</tr>
</tbody></table>
<ul>
<li>SERDE_PARAMS（存储序列化的一些属性、格式信息,比如：行、列分隔符）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>SERDE_ID</strong></td>
<td>序列化类配置ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>PARAM_KEY</strong></td>
<td>属性名</td>
<td>field.delim</td>
</tr>
<tr>
<td><strong>PARAM_VALUE</strong></td>
<td>属性值</td>
<td>,</td>
</tr>
</tbody></table>
<h4 id="5-Hive表字段相关的元数据表"><a href="#5-Hive表字段相关的元数据表" class="headerlink" title="5.Hive表字段相关的元数据表"></a>5.Hive表字段相关的元数据表</h4><ul>
<li>COLUMNS_V2（存储表对应的字段信息）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>CD_ID</strong></td>
<td>字段信息ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>COMMENT</strong></td>
<td>字段注释</td>
<td></td>
</tr>
<tr>
<td><strong>COLUMN_NAME</strong></td>
<td>字段名</td>
<td>pt</td>
</tr>
<tr>
<td><strong>TYPE_NAME</strong></td>
<td>字段类型</td>
<td>string</td>
</tr>
<tr>
<td><strong>INTEGER_IDX</strong></td>
<td>字段顺序</td>
<td>2</td>
</tr>
</tbody></table>
<h4 id="6-Hive表分区相关的元数据表"><a href="#6-Hive表分区相关的元数据表" class="headerlink" title="6.Hive表分区相关的元数据表"></a>6.Hive表分区相关的元数据表</h4><p>主要涉及PARTITIONS、PARTITION_KEYS、PARTITION_KEY_VALS、PARTITION_PARAMS</p>
<ul>
<li>PARTITIONS（存储表分区的基本信息）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>PART_ID</strong></td>
<td>分区ID</td>
<td>1</td>
</tr>
<tr>
<td><strong>CREATE_TIME</strong></td>
<td>分区创建时间</td>
<td></td>
</tr>
<tr>
<td><strong>LAST_ACCESS_TIME</strong></td>
<td>最后一次访问时间</td>
<td></td>
</tr>
<tr>
<td><strong>PART_NAME</strong></td>
<td>分区名</td>
<td>pt=2015-06-12</td>
</tr>
<tr>
<td><strong>SD_ID</strong></td>
<td>分区存储ID</td>
<td>21</td>
</tr>
<tr>
<td><strong>TBL_ID</strong></td>
<td>表ID</td>
<td>2</td>
</tr>
</tbody></table>
<ul>
<li>PARTITION_KEYS（存储分区的字段信息）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>TBL_ID</strong></td>
<td>表ID</td>
<td>2</td>
</tr>
<tr>
<td><strong>PKEY_COMMENT</strong></td>
<td>分区字段说明</td>
<td></td>
</tr>
<tr>
<td><strong>PKEY_NAME</strong></td>
<td>分区字段名</td>
<td>pt</td>
</tr>
<tr>
<td><strong>PKEY_TYPE</strong></td>
<td>分区字段类型</td>
<td>string</td>
</tr>
<tr>
<td><strong>INTEGER_IDX</strong></td>
<td>分区字段顺序</td>
<td>1</td>
</tr>
</tbody></table>
<ul>
<li>PARTITION_KEY_VALS（存储分区字段值）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>PART_ID</strong></td>
<td>分区ID</td>
<td>2</td>
</tr>
<tr>
<td><strong>PART_KEY_VAL</strong></td>
<td>分区字段值</td>
<td>2015-06-12</td>
</tr>
<tr>
<td><strong>INTEGER_IDX</strong></td>
<td>分区字段值顺序</td>
<td>0</td>
</tr>
</tbody></table>
<ul>
<li>PARTITION_PARAMS（存储分区的属性信息）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>说明</strong></th>
<th><strong>示例数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>PART_ID</strong></td>
<td>分区ID</td>
<td>2</td>
</tr>
<tr>
<td><strong>PARAM_KEY</strong></td>
<td>分区属性名</td>
<td>numFiles、numRows</td>
</tr>
<tr>
<td><strong>PARAM_VALUE</strong></td>
<td>分区属性值</td>
<td>15、502195</td>
</tr>
</tbody></table>
<h4 id="7-其他不常用的元数据表"><a href="#7-其他不常用的元数据表" class="headerlink" title="7.其他不常用的元数据表"></a>7.其他不常用的元数据表</h4><ul>
<li><p>DB_PRIVS（数据库权限信息表。通过GRANT语句对数据库授权后，将会在这里存储）</p>
</li>
<li><p>IDXS（索引表，存储Hive索引相关的元数据）</p>
</li>
<li><p>INDEX_PARAMS（索引相关的属性信息）</p>
</li>
<li><p>TAB_COL_STATS（表字段的统计信息，使用ANALYZE语句对表字段分析后记录在这里）</p>
</li>
<li><p>TBL_COL_PRIVS（表字段的授权信息）</p>
</li>
<li><p>PART_PRIVS（分区的授权信息）</p>
</li>
<li><p>PART_COL_STATS（分区字段的统计信息）</p>
</li>
<li><p>PART_COL_PRIVS（分区字段的权限信息）</p>
</li>
<li><p>FUNCS（用户注册的函数信息）</p>
</li>
<li><p>FUNC_RU（用户注册函数的资源信息）</p>
</li>
</ul>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> lxw1234 (</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"> cookieid <span class="keyword">STRING</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"> <span class="keyword">url</span> <span class="keyword">STRING</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"> ua <span class="keyword">STRING</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"> ip <span class="keyword">STRING</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"> createtime <span class="keyword">STRING</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">) </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">COMMENT</span> <span class="string">'This is the page view table'</span> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">partitioned <span class="keyword">BY</span> (<span class="keyword">day</span> <span class="keyword">STRING</span>,site <span class="keyword">STRING</span>) </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">ROW</span> <span class="keyword">FORMAT</span> <span class="keyword">DELIMITED</span> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">','</span> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">stored</span> <span class="keyword">AS</span> ORC;</span></pre></td></tr></table></figure>

<p><strong>建表执行之后，元数据中以下表的数据会有所变化</strong>：</p>
<ul>
<li>TBLS</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="comment">--生成了表lxw1234的基本信息</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TBLS <span class="keyword">WHERE</span> TBL_NAME = ‘lxw1234’;</span></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>TBL_ID</strong></td>
<td>41509</td>
</tr>
<tr>
<td><strong>CREATE_TIME</strong></td>
<td>1436324659</td>
</tr>
<tr>
<td><strong>DB_ID</strong></td>
<td>11</td>
</tr>
<tr>
<td><strong>LAST_ACCESS_TIME</strong></td>
<td>0</td>
</tr>
<tr>
<td><strong>OWNER</strong></td>
<td>liuxiaowen</td>
</tr>
<tr>
<td><strong>RETENTION</strong></td>
<td>0</td>
</tr>
<tr>
<td><strong>SD_ID</strong></td>
<td>91740</td>
</tr>
<tr>
<td><strong>TBL_NAME</strong></td>
<td>lxw1234</td>
</tr>
<tr>
<td><strong>TBL_TYPE</strong></td>
<td>MANAGED_TABLE</td>
</tr>
<tr>
<td><strong>VIEW_EXPANDED_TEXT</strong></td>
<td>NULL</td>
</tr>
<tr>
<td><strong>VIEW_ORIGINAL_TEXT</strong></td>
<td>NULL</td>
</tr>
</tbody></table>
<ul>
<li><p>TABLE_PARAMS</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  *  <span class="keyword">from</span>  TABLE_PARAMS  <span class="keyword">WHERE</span>  TBL_ID=<span class="number">41509</span></span></pre></td></tr></table></figure>

</li>
</ul>
<table>
<thead>
<tr>
<th><strong>TBL_ID</strong></th>
<th><strong>PARAM_KEY</strong></th>
<th><strong>PARAM_VALUE</strong></th>
</tr>
</thead>
<tbody><tr>
<td>41509</td>
<td>comment</td>
<td>This is the page view table</td>
</tr>
<tr>
<td>41509</td>
<td>transient_lastDdlTime</td>
<td>1436324659</td>
</tr>
</tbody></table>
<ul>
<li>SDS</li>
</ul>
<p><strong>SELECT</strong> * <strong>FROM</strong> SDS <strong>WHERE</strong> SD_ID = 91740</p>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>SD_ID</strong></td>
<td>91740</td>
</tr>
<tr>
<td><strong>CD_ID</strong></td>
<td>41564</td>
</tr>
<tr>
<td><strong>INPUT_FORMAT</strong></td>
<td>org.apache.hadoop.hive.ql.io.orc.OrcInputFormat</td>
</tr>
<tr>
<td><strong>IS_COMPRESSED</strong></td>
<td>0</td>
</tr>
<tr>
<td><strong>IS_STOREDASSUBDIRECTORIES</strong></td>
<td>0</td>
</tr>
<tr>
<td><strong>LOCATION</strong></td>
<td>hdfs://namenode/hivedata/warehouse/liuxiaowen.db/lxw1234</td>
</tr>
<tr>
<td><strong>NUM_BUCKETS</strong></td>
<td>-1</td>
</tr>
<tr>
<td><strong>OUTPUT_FORMAT</strong></td>
<td>org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat</td>
</tr>
<tr>
<td><strong>SERDE_ID</strong></td>
<td><strong>91740</strong></td>
</tr>
</tbody></table>
<ul>
<li>SERDES</li>
</ul>
<p><strong>select</strong> * <strong>from</strong> SERDES <strong>WHERE</strong> SERDE_ID = 91740</p>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>SERDE_ID</strong></td>
<td>91740</td>
</tr>
<tr>
<td><strong>NAME</strong></td>
<td></td>
</tr>
<tr>
<td><strong>SLIB</strong></td>
<td>org.apache.hadoop.hive.ql.io.orc.OrcSerde</td>
</tr>
</tbody></table>
<ul>
<li>SERDE_PARAMS</li>
</ul>
<p>select * from  SERDE_PARAMS  WHERE  SERDE_ID=91740</p>
<table>
<thead>
<tr>
<th><strong>SERDE_ID</strong></th>
<th><strong>PARAM_KEY</strong></th>
<th><strong>PARAM_VALUE</strong></th>
</tr>
</thead>
<tbody><tr>
<td>91740</td>
<td>field.delim</td>
<td>,</td>
</tr>
<tr>
<td>91740</td>
<td>serialization.format</td>
<td>,</td>
</tr>
</tbody></table>
<ul>
<li>COLUMNS_V2</li>
</ul>
<p>select * from COLUMNS_V2 WHERE CD_ID=41564 ORDER BY INTEGER_IDX</p>
<table>
<thead>
<tr>
<th><strong>CD_ID</strong></th>
<th><strong>COMMENT</strong></th>
<th><strong>COLUMN_NAME</strong></th>
<th><strong>TYPE_NAME</strong></th>
<th><strong>INTEGER_IDX</strong></th>
</tr>
</thead>
<tbody><tr>
<td>41564</td>
<td></td>
<td>cookieid</td>
<td>string</td>
<td>0</td>
</tr>
<tr>
<td>41564</td>
<td></td>
<td>url</td>
<td>string</td>
<td>1</td>
</tr>
<tr>
<td>41564</td>
<td></td>
<td>ua</td>
<td>string</td>
<td>2</td>
</tr>
<tr>
<td>41564</td>
<td></td>
<td>ip</td>
<td>string</td>
<td>3</td>
</tr>
<tr>
<td>41564</td>
<td></td>
<td>createtime</td>
<td>string</td>
<td>4</td>
</tr>
</tbody></table>
<ul>
<li>PARTITION_KEYS</li>
</ul>
<p>select * from  PARTITION_KEYS  WHERE  TBL_ID=41509</p>
<table>
<thead>
<tr>
<th><strong>TBL_ID</strong></th>
<th><strong>PKEY_COMMENT</strong></th>
<th><strong>PKEY_NAME</strong></th>
<th><strong>PKEY_TYPE</strong></th>
<th><strong>INTEGER_IDX</strong></th>
</tr>
</thead>
<tbody><tr>
<td>41509</td>
<td></td>
<td>day</td>
<td>string</td>
<td>0</td>
</tr>
<tr>
<td>41509</td>
<td></td>
<td>site</td>
<td>string</td>
<td>1</td>
</tr>
</tbody></table>
<ul>
<li>插入数据：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> lxw1234 <span class="keyword">PARTITION</span> (<span class="keyword">day</span> = <span class="string">'2015-07-08'</span>, site = <span class="string">'lxw1234.com'</span>) </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="string">'cookie1'</span> <span class="keyword">AS</span> cookieid,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="string">'http://lxw1234.com'</span> <span class="keyword">AS</span> <span class="keyword">url</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="string">'firefox'</span> <span class="keyword">AS</span> ua,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="string">'127.0.0.1'</span> <span class="keyword">AS</span> ip,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="string">'2015-07-08 11:00:01'</span> <span class="keyword">AS</span> createtime </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> dual </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">limit</span> <span class="number">1</span>;</span></pre></td></tr></table></figure>

<p><strong>插入数据执行完之后，以下表的元数据发生变化：</strong></p>
<ul>
<li>PARTITIONS</li>
</ul>
<p>select * from  <code>PARTITIONS</code>  WHERE  TBL_ID=41509</p>
<table>
<thead>
<tr>
<th><strong>PART_ID</strong></th>
<th><strong>CREATE_TIME</strong></th>
<th><strong>LAST_ACCESS_TIME</strong></th>
<th><strong>PART_NAME</strong></th>
<th><strong>SD_ID</strong></th>
<th><strong>TBL_ID</strong></th>
</tr>
</thead>
<tbody><tr>
<td>54472</td>
<td>1436325812</td>
<td>0</td>
<td>day=2015-07-08/site=lxw1234.com</td>
<td>91746</td>
<td>41509</td>
</tr>
</tbody></table>
<ul>
<li>SDS</li>
</ul>
<p>select *  from  SDS  WHERE  SD_ID=91746</p>
<p>注意：这里的存储和表的存储是不同的，因为每个分区也会有一个SD</p>
<table>
<thead>
<tr>
<th><strong>元数据表字段</strong></th>
<th><strong>数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>SD_ID</strong></td>
<td><strong>91746</strong></td>
</tr>
<tr>
<td><strong>CD_ID</strong></td>
<td>41564</td>
</tr>
<tr>
<td><strong>INPUT_FORMAT</strong></td>
<td>org.apache.hadoop.hive.ql.io.orc.OrcInputFormat</td>
</tr>
<tr>
<td><strong>IS_COMPRESSED</strong></td>
<td>0</td>
</tr>
<tr>
<td><strong>IS_STOREDASSUBDIRECTORIES</strong></td>
<td>0</td>
</tr>
<tr>
<td><strong>LOCATION</strong></td>
<td>hdfs://namenode/hivedata/warehouse/liuxiaowen.db/lxw1234/day=2015-07-08/site=lxw1234.com</td>
</tr>
<tr>
<td><strong>NUM_BUCKETS</strong></td>
<td>-1</td>
</tr>
<tr>
<td><strong>OUTPUT_FORMAT</strong></td>
<td>org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat</td>
</tr>
<tr>
<td><strong>SERDE_ID</strong></td>
<td><strong>91746</strong></td>
</tr>
</tbody></table>
<ul>
<li>PARTITION_KEY_VALS</li>
</ul>
<p>select  *  from  PARTITION_KEY_VALS  where  PART_ID=54472</p>
<table>
<thead>
<tr>
<th><strong>PART_ID</strong></th>
<th><strong>PART_KEY_VAL</strong></th>
<th><strong>INTEGER_IDX</strong></th>
</tr>
</thead>
<tbody><tr>
<td>54472</td>
<td>2015-07-08</td>
<td>0</td>
</tr>
<tr>
<td>54472</td>
<td>lxw1234.com</td>
<td>1</td>
</tr>
</tbody></table>
<ul>
<li>PARTITION_PARAMS</li>
</ul>
<p>select * from PARTITION_PARAMS where PART_ID = 54472</p>
<table>
<thead>
<tr>
<th><strong>PART_ID</strong></th>
<th><strong>PARAM_KEY</strong></th>
<th><strong>PARAM_VALUE</strong></th>
</tr>
</thead>
<tbody><tr>
<td>54472</td>
<td>COLUMN_STATS_ACCURATE</td>
<td>true</td>
</tr>
<tr>
<td>54472</td>
<td>numFiles</td>
<td>1</td>
</tr>
<tr>
<td>54472</td>
<td>numRows</td>
<td>1</td>
</tr>
<tr>
<td>54472</td>
<td>rawDataSize</td>
<td>408</td>
</tr>
<tr>
<td>54472</td>
<td>totalSize</td>
<td>703</td>
</tr>
<tr>
<td>54472</td>
<td>transient_lastDdlTime</td>
<td>1436325813</td>
</tr>
</tbody></table>
<p>文章转自：<a href="http://lxw1234.com/archives/2015/07/378.htm" target="_blank" rel="noopener">http://lxw1234.com/archives/2015/07/378.htm</a></p>
</div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hive/">Hive</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/11/10/%E5%8F%8C11_%E8%AE%A9%E6%88%91%E9%81%87%E8%A7%81%E4%BD%A0/"><i class="fa fa-chevron-left">  </i><span>双11_让我遇见你</span></a></div><div class="next-post pull-right"><a href="/2019/10/31/%E9%87%8D%E8%B0%88%E7%BB%B4%E5%BA%A6%E8%A1%A8%E8%AE%BE%E8%AE%A1/"><span>重谈维度表设计</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By zhiyong.chen</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>