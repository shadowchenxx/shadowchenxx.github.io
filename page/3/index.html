<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="zhiyong.chen"><meta name="copyright" content="zhiyong.chen"><title>胆小认生，不易相处 | Shadowchen's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">zhiyong.chen</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">66</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">64</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Shadowchen's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="site-info"><div id="site-title">Shadowchen's Blog</div><div id="site-sub-title">胆小认生，不易相处</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/23/Spark%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">Spark源码分析</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-23</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Spark%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">Spark源码分析</a></span><div class="content"><p>#Spark运行模式及原理</p>
<p><strong>1.概述</strong></p>
<p>spark运行模式多种多样，分为以下几种:</p>
<ul>
<li>本地模式</li>
<li>伪分布式</li>
<li>集群<ul>
<li>standalone</li>
<li>mesos</li>
<li>hadoop yarn</li>
</ul>
</li>
</ul></div><a class="more" href="/2019/08/23/Spark%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/16/Scala/">Scala</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-16</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Scala/">Scala</a></span><div class="content"><h1 id="Scala编程基础"><a href="#Scala编程基础" class="headerlink" title="Scala编程基础"></a>Scala编程基础</h1><p>Scala是一个面向对象的函数式编程语言，在Scala中，一切皆函数。</p>
<p>函数式编程的优点：</p>
<ul>
<li><p>提高生产效率，代码量更小。</p>
</li>
<li><p>更容易编写多并发或多进程的应用。</p>
</li>
<li><p>带来更少的bug，代码量小了，bug自然就小了。</p></div><a class="more" href="/2019/08/16/Scala/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/12/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E5%85%AD%EF%BC%89/">数据仓库（六）</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-12</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E8%A7%A3%E6%9E%90/">维度建模解析</a></span><div class="content"><h1 id="维度建模详解"><a href="#维度建模详解" class="headerlink" title="维度建模详解"></a>维度建模详解</h1><p>这篇文章主要是上一篇维度建模涉及到的概念补充。<a href="[https://shadowchenxx.github.io/2019/08/08/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E4%BA%94%EF%BC%89/](https://shadowchenxx.github.io/2019/08/08/数据仓库（五）/)">传送门</a></p>
<p><strong>1.范式</strong></p>
<ul>
<li>第一范式：表中字段属性不能再被拆分，分隔</li>
<li>第二范式：满足第一范式，且表必有主键，主键外的字段对主键依赖</li>
<li>第三范式：满足第二范式，主键外的其他字段不互相依赖</li>
</ul></div><a class="more" href="/2019/08/12/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E5%85%AD%EF%BC%89/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/08/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E4%BA%94%EF%BC%89/">数据仓库（五）</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-08</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a></span><div class="content"><h1 id="维度建模的四个步骤"><a href="#维度建模的四个步骤" class="headerlink" title="维度建模的四个步骤"></a>维度建模的四个步骤</h1><ul>
<li><p>选择业务流程</p>
</li>
<li><p>声明粒度</p>
</li>
<li><p>确定维度</p>
</li>
<li><p>确定事实</p></div><a class="more" href="/2019/08/08/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E4%BA%94%EF%BC%89/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/06/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E5%9B%9B%EF%BC%89/">数据仓库（四）</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-06</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E8%A1%A8%E5%88%86%E7%B1%BB/">表分类</a></span><div class="content"><h1 id="hive表分类"><a href="#hive表分类" class="headerlink" title="hive表分类"></a>hive表分类</h1><h3 id="1-内外部表"><a href="#1-内外部表" class="headerlink" title="1.内外部表"></a>1.内外部表</h3><ul>
<li><p>管理表（内表）</p>
<p>由hive.site.xml文件中属性hive.metastore.warehouse.dir所定义目录的子目录之下。当我们删除一个管理表时，hive也会删除这个表中的数据。</p>
</li>
<li><p>外部表</p></div><a class="more" href="/2019/08/06/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E5%9B%9B%EF%BC%89/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/05/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93(%E4%B8%89)/">数据仓库(三)</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-05</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hive/">hive</a></span><div class="content"><h1 id="Hive四种存储格式解析"><a href="#Hive四种存储格式解析" class="headerlink" title="Hive四种存储格式解析"></a>Hive四种存储格式解析</h1><ul>
<li>TEXTFILE</li>
<li>SEQUENCEFILE</li>
<li>RCFILE</li>
<li>ORCFILE</li>
</ul>
<h3 id="1-Textfile"><a href="#1-Textfile" class="headerlink" title="1.Textfile"></a>1.Textfile</h3><p>普通的文本型文件，是Hadoop中最常见的输出格式，也是hive的默认文件格式。</p></div><a class="more" href="/2019/08/05/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93(%E4%B8%89)/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/05/%E5%87%8C%E6%99%A8%E4%B8%89%E7%82%B9/">凌晨三点</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-05</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E9%9A%8F%E7%AC%94/">随笔</a></span><div class="content"><p><img src="https://raw.githubusercontent.com/shadowchenxx/markdown_pic/master/pictures/shanghai.png" alt="凌晨三点的上海">还是小的时候，乡下日子，白天和黑夜泾渭分明的。</p>
<p>天不用经过任何人允许，兀自黑暗，没有路灯，没有汽车灯光，当然也没有艳丽明晃的霓虹灯，整个村子隐入安静的夜幕之中，只有稀疏的几粒烟火烁动。倘若是在七八月的夏天，乡下没有空调，没有冷气，院中间搁张竹席，三两人拿把竹扇子，一边赶蚊子，一边消消汗气，说上几句家长里短的闲话，又各自散去。</p></div><a class="more" href="/2019/08/05/%E5%87%8C%E6%99%A8%E4%B8%89%E7%82%B9/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/02/%E6%BC%AB%E8%B0%88%E6%95%B0%E6%8D%AE%E8%B4%A8%E9%87%8F%E7%9B%91%E6%8E%A7/">数据质量[转载]</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-02</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E8%B4%A8%E9%87%8F/">数据质量</a></span><div class="content"><h1 id="漫谈数据质量监控"><a href="#漫谈数据质量监控" class="headerlink" title="漫谈数据质量监控"></a>漫谈数据质量监控</h1><blockquote>
<p>往往那些不起眼的功能，最能毁掉你的工作成果。</p>
</blockquote>
<p>本篇分享一些和数据质量监控相关的内容。数据质量监控是一个在快速发展的业务中最容易被牺牲和忽略的功能，但是它确实至关重要的。</p></div><a class="more" href="/2019/08/02/%E6%BC%AB%E8%B0%88%E6%95%B0%E6%8D%AE%E8%B4%A8%E9%87%8F%E7%9B%91%E6%8E%A7/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/01/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89/">数据仓库（二）</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-01</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a></span><div class="content"><h1 id="数据仓库设计基础"><a href="#数据仓库设计基础" class="headerlink" title="数据仓库设计基础"></a>数据仓库设计基础</h1><h2 id="一、关系数据模型"><a href="#一、关系数据模型" class="headerlink" title="一、关系数据模型"></a>一、关系数据模型</h2><p>核心还是范式设计（特点：非冗余行、稳定性、一致性、灵活性）</p>
<h2 id="二、多维数据模型"><a href="#二、多维数据模型" class="headerlink" title="二、多维数据模型"></a>二、多维数据模型</h2><p>事实、维度和粒度是维度模型中的核心概念，维度模型通常是以一种星型模式的方式构建。</p>
<p>还有一种是雪花模型，是一种对维度表范式化之后的形式（适用于多个维表中共用一个属性，因为主要是为了节省存储空间，而现在的大数据框架下，暂时不考虑～🐶）<br><strong>1.一般维度建模的流程</strong>：</div><a class="more" href="/2019/08/01/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/07/31/Hive-%E8%A7%A3%E5%86%B3Hive%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E6%95%B0%E8%BF%87%E5%A4%9A%E7%9A%84%E9%97%AE%E9%A2%98/">Hive-解决Hive创建文件数过多的问题</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-31</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hive/">hive</a></span><div class="content"><hr>
<h3 id="1-问题背景"><a href="#1-问题背景" class="headerlink" title="1.问题背景:"></a>1.问题背景:</h3><p>　今天将临时表里面的数据按照天分区插入到线上的表中去，出现了<a href="https://www.iteblog.com/archives/tag/hive/" target="_blank" rel="noopener">Hive</a>创建的文件数大于100000个的情况，我的SQL如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hive&gt; insert overwrite table test partition(dt)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">		 &gt; select * from iteblog_tmp;</span></pre></td></tr></table></figure>

<p>iteblog_tmp表里面一共有570多G的数据，一共可以分成76个分区，SQL运行的时候创建了2163个Mapper，0个Reducers。程序运行到一般左右的时候出现了以下的异常：</div><a class="more" href="/2019/07/31/Hive-%E8%A7%A3%E5%86%B3Hive%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E6%95%B0%E8%BF%87%E5%A4%9A%E7%9A%84%E9%97%AE%E9%A2%98/#more">Read more</a><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/">&lt;i class&#x3D;&quot;fa fa-chevron-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/">&lt;i class&#x3D;&quot;fa fa-chevron-right&quot;&gt;&lt;&#x2F;i&gt;</a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By zhiyong.chen</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>